{% extends 'core/base.html' %}
{% block content %}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">

            <!--Mensajes emergentes-->
            {% if messages %}
                {% for message in messages %}
                    <div id="message-{{ forloop.counter }}" class="alert alert-dismissible alert-success">
                        <button type="button" class="close" data-dismiss="alert">&times;</button>
                        <strong class="text-dark">{{ message }}</strong>
                    </div>
                {% endfor %}
            {% endif %}
            <script>
                setTimeout(function() {
                    document.querySelectorAll('[id^="message-"]').forEach(function(element) {
                        element.remove();
                    });
                }, 5000); // 5000 milisegundos = 5 segundos
            </script>

            <h2>Gestión de publicacion</h2>
            <div class="card">
                <div class="card-body">
                    <form action="/registrarPublicacion/" method="POST">{% csrf_token %}
                    
                        <div class="form-group mb-4">
                            <label for="txtCodigo">Codigo:</label>
                            <input type="text" id="txtCodigo" name="txtCodigo" class="form-control" placeholder="Código"
                                minlength="6" maxlength="6" required>
                        </div>
                        
                        <div class="form-group mb-4">
                            <label for="txtTitulo">Titulo:</label>
                            <input type="text" id="txtTitulo" name="txtTitulo" class="form-control" placeholder="Titulo"
                                maxlength="50" required>
                        </div>
                    
                        <div class="form-group mb-4">
                            <label for="numPrecio">Precio:</label>
                            <input type="text" id="numPrecio" name="numPrecio" class="form-control" min="1" max="9"
                                value="1" required>
                        </div>

                        <div class="input-group mt-3 mb-4">
                            <div style="display: flex; flex-direction: column;">

                                <label for="numCantidad">Cantidad del Producto:</label>
                                <input type="text" id="numCantidad" name="numCantidad" class="form-control" min="1" max="9"
                                    value="1" required placeholder="Cantidad" aria-label="Cantidad" />
                            </div>

                            <div style="display: flex; flex-direction: column;">
                                <label for="txtUnidad">Unidad:</label>
                                <select class="form-select" id="txtUnidad" name="txtUnidad">
                                    <option selected>Unidad</option>
                                    <option value="Kg">Kg</option>
                                    <option value="g">g</option>
                                    <option value="L">L</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group mb-4">
                            <label for="txtCategoria">Categoría:</label>
                            <select class="form-select" id="txtCategoria" name="txtCategoria">
                                <option selected>Selecciona una opcion</option>
                                <option value="Vegetales">Vegetales</option>
                                <option value="Frutas">Frutas</option>
                                <option value="Hierbas">Hierbas</option>
                            </select>
                        </div>


                        <!--<div class="input-group mt-3" >
                            <div class="input-group-text">Fecha de Cosecha</div>
                            <input type="date" id="DateFechaCosecha" name="DateFechaCosecha" class="form-control" >
                        </div>-->


                        <div class="form-group mb-4">
                            <label for="txtDescripcion">Descripcion:</label>
                            <textarea type="text" id="txtDescripcion" name="txtDescripcion" class="form-control" placeholder="Descripcion"
                                maxlength="200" required  ></textarea>
                        </div>
                        
                        <div class="form-group mb-4">
                            <button type="submit" class="btn btn-success btn-block text-white">Guardar</button>
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>    
    </div>
    
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                               Mostrar Publicaciones   -->

    <div class="row justify-content-center mt-4">
        <h1>Listado de publicaciones</h1>
        <div class="table-responsive py-2">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Código</th>
                        <th>Titulo</th>
                        <th>Precio</th>
                        <th>Cantidad</th>
                        <th>Categoria</th>
                        <th>Unidad</th>
<!--                     <th>FechaCosecha</th>
-->
                        <th>Descripcion</th>

                        <th colspan="2">Opciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% if publicaciones %}
                        <ul>
                        {% for c in publicaciones %}
                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{c.codigo}}</td>
                            <td>{{c.titulo}}</td>
                            <td>{{c.precio}}</td>
                            <td>{{c.cantidad}}</td>
                            <td>{{c.categoria}}</td>
                            <td>{{c.unidad}}</td>
    <!--                    <td>{{c.fechaCosecha}}</td>     
    -->                     <td>{{c.descripcion}}</td>
                            <td><a href="edicionPublicacion/{{c.codigo}}" class="btn btn-info">Editar</a></td>
                            <td><a href="eliminarPublicacion/{{c.codigo}}" class="btn btn-danger btnEliminacion">Eliminar</a></td>
                        </tr> 
                        {% endfor %}
                        </ul>

                    {% else %}
                        <p>No tienes publicaciones aún.</p>
                    {% endif %}

                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}